{% extends "_base.html" %}
{% block title %}{{ policy.title }}{% endblock %}

{% block content %}
<h1>{{ policy.title }}</h1>

<p style="color:#64748b;font-size:.9rem;margin-bottom:.5rem;">
  <strong>Category:</strong> {{ policy.get_category_display }}
  Â· <strong>Version:</strong> {{ policy.version }}
  {% if policy.team %}
    Â· <strong>Team:</strong> {{ policy.team.name }}
  {% endif %}
  {% if policy.owner %}
    Â· <strong>Owner:</strong> {{ policy.owner.username }}
  {% endif %}
</p>

<p style="color:#94a3b8;font-size:.85rem;margin-bottom:1rem;">
  Updated {{ policy.updated_at|date:"Y-m-d H:i" }}
</p>

{% if not policy.approved or policy.visibility == "team" %}
  <p class="alert alert-warning">
    {% if not policy.approved %}
      This policy is a <strong>draft</strong>. Only your team and instructors can see it.
    {% elif policy.visibility == "team" %}
      This policy is currently <strong>team-only</strong>. Publish it to share with the whole class.
    {% endif %}
  </p>
{% endif %}

<article class="markdown-body">
  {{ policy.html|safe }}
</article>

<div style="margin-top:1.25rem;display:flex;gap:.75rem;flex-wrap:wrap;">
  <a href="{% url 'policies:list' %}" class="btn">
    â† Back to Policies
  </a>

  {% if can_edit %}
    <a href="{% url 'policies:edit' policy.slug %}" class="btn">
      âœï¸ Edit
    </a>
  {% endif %}

  {% if can_publish and policy.visibility != "class" %}
    <form action="{% url 'policies:publish' policy.slug %}" method="post" style="display:inline;">
      {% csrf_token %}
      <button type="submit" class="btn">
        ğŸŒ Publish to class
      </button>
    </form>
  {% endif %}
</div>

{% endblock %}
