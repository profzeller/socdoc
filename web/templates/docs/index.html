{% extends "_base.html" %}
{% block title %}Docs{% endblock %}

{% block content %}
<h1>Documentation</h1>

{% if user.is_authenticated and user.profile.team %}
  <p style="color:#94a3b8;font-size:.9rem;">
    You are on team <strong>{{ user.profile.team.name }}</strong>.
    You can see your team’s docs and any pages published to the whole class.
  </p>
{% else %}
  <p style="color:#94a3b8;font-size:.9rem;">
    You are viewing pages published to the whole class.
  </p>
{% endif %}

{% if user.is_authenticated %}
  <p><a href="{% url 'docs:create' %}">➕ Create New Page</a></p>
{% endif %}

{% if categories %}
  <h2>By Category</h2>
  {% for cat in categories %}
    <h3>{{ cat.name }}</h3>
    <ul>
      {% for p in pages %}
        {% if p.category_id == cat.id %}
          <li>
            <a href="{% url 'docs:detail' p.slug %}">{{ p.title }}</a>
            {% if p.team %}
              <span style="color:#0f766e;font-size:.85rem;">(Team: {{ p.team.name }})</span>
            {% endif %}
          </li>
        {% endif %}
      {% empty %}
        <li>No pages yet.</li>
      {% endfor %}
    </ul>
  {% endfor %}
{% endif %}

<h2>All Pages</h2>
<ul>
  {% for p in pages %}
    <li>
      <a href="{% url 'docs:detail' p.slug %}">{{ p.title }}</a>
      {% if p.category %}
        <span style="color:#64748b;font-size:.85rem;">[{{ p.category.name }}]</span>
      {% endif %}
      {% if p.team %}
        <span style="color:#0f766e;font-size:.85rem;">(Team: {{ p.team.name }})</span>
      {% endif %}
    </li>
  {% empty %}
    <li>No documentation pages yet.</li>
  {% endfor %}
</ul>
{% endblock %}
